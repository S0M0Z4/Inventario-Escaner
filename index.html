<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Anuncios - Iglesia</title>
    <style>
        /* Estilos generales */
        :root {
            --azul-principal: #1e3a8a;
            --azul-secundario: #3b82f6;
            --azul-claro: #dbeafe;
            --blanco: #ffffff;
            --gris-claro: #f3f4f6;
            --gris: #9ca3af;
            --gris-oscuro: #374151;
            --sombra: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--gris-claro);
            color: var(--gris-oscuro);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* Encabezado */
        .header {
            background-color: var(--azul-principal);
            color: var(--blanco);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--sombra);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .logo-icon {
            font-size: 2rem;
        }
        
        /* Formulario de login */
        .login-container {
            position: relative;
        }
        
        .login-btn {
            background-color: var(--azul-secundario);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .login-btn:hover {
            background-color: #2563eb;
        }
        
        .login-form {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--blanco);
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: var(--sombra);
            width: 300px;
            display: none;
            z-index: 100;
            margin-top: 0.5rem;
        }
        
        .login-form.active {
            display: block;
        }
        
        .login-form h3 {
            margin-bottom: 1rem;
            color: var(--azul-principal);
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.3rem;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 0.7rem;
            border: 1px solid var(--gris);
            border-radius: 4px;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--azul-secundario);
        }
        
        .submit-btn {
            background-color: var(--azul-principal);
            color: white;
            border: none;
            padding: 0.7rem;
            width: 100%;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.3s;
            margin-top: 0.5rem;
        }
        
        .submit-btn:hover {
            background-color: #1d4ed8;
        }
        
        .logout-btn {
            background-color: #dc2626;
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.3s;
            display: none;
        }
        
        .logout-btn:hover {
            background-color: #b91c1c;
        }
        
        /* Contenedor principal */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }
        
        /* Sección de formulario de anuncios */
        .announcement-form-section {
            background-color: var(--blanco);
            border-radius: 8px;
            padding: 2rem;
            box-shadow: var(--sombra);
            margin-bottom: 2rem;
        }
        
        .section-title {
            color: var(--azul-principal);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--azul-claro);
        }
        
        .announcement-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .form-control {
            display: flex;
            flex-direction: column;
        }
        
        .form-control label {
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .form-control select, 
        .form-control input, 
        .form-control textarea {
            padding: 0.7rem;
            border: 1px solid var(--gris);
            border-radius: 4px;
        }
        
        .form-control textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-control select:focus, 
        .form-control input:focus, 
        .form-control textarea:focus {
            outline: none;
            border-color: var(--azul-secundario);
        }
        
        .btn-submit-announcement {
            grid-column: 1 / -1;
            background-color: var(--azul-principal);
            color: white;
            border: none;
            padding: 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .btn-submit-announcement:hover {
            background-color: #1d4ed8;
        }
        
        /* Sección de anuncios */
        .announcements-section {
            background-color: var(--blanco);
            border-radius: 8px;
            padding: 2rem;
            box-shadow: var(--sombra);
        }
        
        .category-filter {
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .category-filter label {
            font-weight: 500;
        }
        
        .category-filter select {
            padding: 0.5rem;
            border: 1px solid var(--gris);
            border-radius: 4px;
            min-width: 200px;
        }
        
        .announcements-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .announcement-card {
            background-color: var(--azul-claro);
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid var(--azul-principal);
        }
        
        .announcement-card h3 {
            color: var(--azul-principal);
            margin-bottom: 0.5rem;
        }
        
        .announcement-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--gris-oscuro);
        }
        
        .announcement-category {
            background-color: var(--azul-secundario);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .announcement-description {
            margin-top: 1rem;
            line-height: 1.5;
        }
        
        /* Panel de administrador */
        .admin-panel {
            display: none;
        }
        
        .admin-panel.active {
            display: block;
        }
        
        .admin-announcements {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        /* Mensajes */
        .message {
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1.5rem;
            text-align: center;
            display: none;
        }
        
        .message.success {
            background-color: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
            display: block;
        }
        
        .message.error {
            background-color: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
            display: block;
        }
        
        .empty-message {
            grid-column: 1 / -1;
            text-align: center;
            padding: 2rem;
            color: var(--gris);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .login-container {
                position: static;
            }
            
            .login-form {
                position: static;
                width: 100%;
                margin-top: 1rem;
            }
            
            .announcement-form {
                grid-template-columns: 1fr;
            }
            
            .announcements-container, .admin-announcements {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Encabezado con login -->
    <header class="header">
        <div class="logo">
            <div class="logo-icon">⛪</div>
            <h1>Gestor de Anuncios - Iglesia</h1>
        </div>
        <div class="login-container">
            <button id="loginBtn" class="login-btn">Iniciar Sesión Administrador</button>
            <div id="loginForm" class="login-form">
                <h3>Acceso Administrador</h3>
                <div class="form-group">
                    <label for="username">Usuario:</label>
                    <input type="text" id="username" placeholder="Ingresa tu usuario">
                </div>
                <div class="form-group">
                    <label for="password">Contraseña:</label>
                    <input type="password" id="password" placeholder="Ingresa tu contraseña">
                </div>
                <button id="submitLogin" class="submit-btn">Ingresar</button>
                <p style="margin-top: 0.7rem; font-size: 0.85rem; color: #666;">
                    Credenciales: Usuario: <strong>Admin</strong>, Contraseña: <strong>Aa.1234#</strong>
                </p>
            </div>
            <button id="logoutBtn" class="logout-btn">Cerrar Sesión</button>
        </div>
    </header>

    <!-- Contenido principal -->
    <main class="container">
        <!-- Formulario para crear anuncios -->
        <section class="announcement-form-section">
            <h2 class="section-title">Crear Nuevo Anuncio</h2>
            <form id="announcementForm" class="announcement-form">
                <div class="form-control">
                    <label for="category">Categoría:</label>
                    <select id="category" required>
                        <option value="" disabled selected>Selecciona una categoría</option>
                        <option value="Ministerio Juvenil">Ministerio Juvenil</option>
                        <option value="Ministerio Personal">Ministerio Personal</option>
                        <option value="Ministerio de la Mujer">Ministerio de la Mujer</option>
                        <option value="Ancianos">Ancianos</option>
                        <option value="Diáconos">Diáconos</option>
                        <option value="Escuela Sabática">Escuela Sabática</option>
                        <option value="Evangelismo">Evangelismo</option>
                        <option value="Música y Alabanza">Música y Alabanza</option>
                    </select>
                </div>
                <div class="form-control">
                    <label for="time">Hora del evento:</label>
                    <input type="time" id="time" required>
                </div>
                <div class="form-control">
                    <label for="title">Título del anuncio:</label>
                    <input type="text" id="title" placeholder="Ej: Reunión de oración" required>
                </div>
                <div class="form-control full-width">
                    <label for="description">Descripción:</label>
                    <textarea id="description" placeholder="Describe los detalles del anuncio..." required></textarea>
                </div>
                <button type="submit" class="btn-submit-announcement">Publicar Anuncio</button>
            </form>
            <div id="formMessage" class="message"></div>
        </section>

        <!-- Sección para mostrar anuncios (vista normal) -->
        <section class="announcements-section">
            <h2 class="section-title">Anuncios Publicados</h2>
            <div class="category-filter">
                <label for="filterCategory">Filtrar por categoría:</label>
                <select id="filterCategory">
                    <option value="all">Todas las categorías</option>
                    <option value="Ministerio Juvenil">Ministerio Juvenil</option>
                    <option value="Ministerio Personal">Ministerio Personal</option>
                    <option value="Ministerio de la Mujer">Ministerio de la Mujer</option>
                    <option value="Ancianos">Ancianos</option>
                    <option value="Diáconos">Diáconos</option>
                    <option value="Escuela Sabática">Escuela Sabática</option>
                    <option value="Evangelismo">Evangelismo</option>
                    <option value="Música y Alabanza">Música y Alabanza</option>
                </select>
            </div>
            <div id="announcementsContainer" class="announcements-container">
                <!-- Los anuncios se cargarán aquí dinámicamente -->
                <div class="empty-message" id="emptyMessage">
                    No hay anuncios para mostrar. ¡Crea el primer anuncio!
                </div>
            </div>
        </section>

        <!-- Panel de administrador (solo visible al iniciar sesión) -->
        <section id="adminPanel" class="announcements-section admin-panel">
            <h2 class="section-title">Panel de Administrador - Todos los Anuncios</h2>
            <div id="adminAnnouncements" class="admin-announcements">
                <!-- Los anuncios del panel de administrador se cargarán aquí -->
                <div class="empty-message" id="adminEmptyMessage">
                    No hay anuncios para mostrar.
                </div>
            </div>
        </section>
    </main>

    <script>
        // Datos de ejemplo para inicializar la aplicación
        const initialAnnouncements = [
            {
                id: 1,
                category: "Ministerio Juvenil",
                time: "18:00",
                title: "Retiro Espiritual Juvenil",
                description: "Retiro juvenil en la montaña este fin de semana. Traer ropa abrigadora y Biblia.",
                date: "2023-10-15"
            },
            {
                id: 2,
                category: "Escuela Sabática",
                time: "09:30",
                title: "Estudio de la Lección 5",
                description: "Estudio de la lección de esta semana en el salón principal. Todos invitados.",
                date: "2023-10-20"
            },
            {
                id: 3,
                category: "Ministerio de la Mujer",
                time: "15:00",
                title: "Reunión de Oración",
                description: "Reunión de oración especial por las familias de la congregación.",
                date: "2023-10-18"
            }
        ];

        // Credenciales de administrador
        const ADMIN_CREDENTIALS = {
            username: "Admin",
            password: "Aa.1234#"
        };

        // Estado de la aplicación
        let announcements = [];
        let isAdminLoggedIn = false;
        let nextId = 4;

        // Elementos del DOM
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const loginForm = document.getElementById('loginForm');
        const submitLogin = document.getElementById('submitLogin');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const announcementForm = document.getElementById('announcementForm');
        const announcementsContainer = document.getElementById('announcementsContainer');
        const adminPanel = document.getElementById('adminPanel');
        const adminAnnouncements = document.getElementById('adminAnnouncements');
        const filterCategory = document.getElementById('filterCategory');
        const formMessage = document.getElementById('formMessage');
        const emptyMessage = document.getElementById('emptyMessage');
        const adminEmptyMessage = document.getElementById('adminEmptyMessage');

        // Inicializar la aplicación
        function initApp() {
            // Cargar anuncios desde localStorage o usar datos iniciales
            const savedAnnouncements = localStorage.getItem('churchAnnouncements');
            
            if (savedAnnouncements) {
                announcements = JSON.parse(savedAnnouncements);
                // Encontrar el ID más alto para continuar la numeración
                if (announcements.length > 0) {
                    nextId = Math.max(...announcements.map(ann => ann.id)) + 1;
                }
            } else {
                announcements = initialAnnouncements;
                saveAnnouncements();
            }
            
            // Verificar si hay sesión de administrador activa
            const adminSession = localStorage.getItem('adminSession');
            if (adminSession === 'active') {
                isAdminLoggedIn = true;
                updateLoginUI();
            }
            
            // Renderizar anuncios iniciales
            renderAnnouncements();
            
            // Configurar event listeners
            setupEventListeners();
        }

        // Configurar event listeners
        function setupEventListeners() {
            // Toggle formulario de login
            loginBtn.addEventListener('click', () => {
                loginForm.classList.toggle('active');
            });
            
            // Cerrar formulario de login al hacer clic fuera
            document.addEventListener('click', (e) => {
                if (!loginForm.contains(e.target) && e.target !== loginBtn) {
                    loginForm.classList.remove('active');
                }
            });
            
            // Enviar formulario de login
            submitLogin.addEventListener('click', handleLogin);
            
            // También permitir login con Enter
            passwordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });
            
            // Cerrar sesión
            logoutBtn.addEventListener('click', handleLogout);
            
            // Enviar formulario de anuncio
            announcementForm.addEventListener('submit', handleAnnouncementSubmit);
            
            // Filtrar anuncios por categoría
            filterCategory.addEventListener('change', renderAnnouncements);
        }

        // Manejar login de administrador
        function handleLogin() {
            const username = usernameInput.value.trim();
            const password = passwordInput.value;
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                isAdminLoggedIn = true;
                localStorage.setItem('adminSession', 'active');
                updateLoginUI();
                showMessage('Sesión de administrador iniciada correctamente.', 'success');
                loginForm.classList.remove('active');
                usernameInput.value = '';
                passwordInput.value = '';
            } else {
                showMessage('Credenciales incorrectas. Intenta nuevamente.', 'error');
            }
        }

        // Manejar logout de administrador
        function handleLogout() {
            isAdminLoggedIn = false;
            localStorage.removeItem('adminSession');
            updateLoginUI();
            showMessage('Sesión de administrador cerrada.', 'success');
        }

        // Actualizar la UI según el estado de login
        function updateLoginUI() {
            if (isAdminLoggedIn) {
                loginBtn.style.display = 'none';
                logoutBtn.style.display = 'block';
                adminPanel.classList.add('active');
                renderAdminAnnouncements();
            } else {
                loginBtn.style.display = 'block';
                logoutBtn.style.display = 'none';
                adminPanel.classList.remove('active');
            }
        }

        // Manejar envío de nuevo anuncio
        function handleAnnouncementSubmit(e) {
            e.preventDefault();
            
            // Obtener valores del formulario
            const category = document.getElementById('category').value;
            const time = document.getElementById('time').value;
            const title = document.getElementById('title').value.trim();
            const description = document.getElementById('description').value.trim();
            
            // Validar campos
            if (!category || !time || !title || !description) {
                showMessage('Por favor completa todos los campos.', 'error');
                return;
            }
            
            // Crear nuevo anuncio
            const newAnnouncement = {
                id: nextId++,
                category,
                time,
                title,
                description,
                date: new Date().toISOString().split('T')[0] // Fecha actual en formato YYYY-MM-DD
            };
            
            // Agregar al array de anuncios
            announcements.push(newAnnouncement);
            
            // Guardar en localStorage
            saveAnnouncements();
            
            // Limpiar formulario
            announcementForm.reset();
            
            // Mostrar mensaje de éxito
            showMessage('Anuncio publicado exitosamente.', 'success');
            
            // Actualizar la visualización
            renderAnnouncements();
            
            // Si el admin está logueado, actualizar su vista también
            if (isAdminLoggedIn) {
                renderAdminAnnouncements();
            }
        }

        // Guardar anuncios en localStorage
        function saveAnnouncements() {
            localStorage.setItem('churchAnnouncements', JSON.stringify(announcements));
        }

        // Renderizar anuncios según la categoría seleccionada
        function renderAnnouncements() {
            const selectedCategory = filterCategory.value;
            
            // Filtrar anuncios según la categoría seleccionada
            let filteredAnnouncements = announcements;
            if (selectedCategory !== 'all') {
                filteredAnnouncements = announcements.filter(ann => ann.category === selectedCategory);
            }
            
            // Mostrar mensaje si no hay anuncios
            if (filteredAnnouncements.length === 0) {
                emptyMessage.style.display = 'block';
                announcementsContainer.innerHTML = '';
                announcementsContainer.appendChild(emptyMessage);
                return;
            }
            
            // Ocultar mensaje de vacío
            emptyMessage.style.display = 'none';
            
            // Generar HTML de los anuncios
            let announcementsHTML = '';
            
            // Ordenar por fecha (más reciente primero)
            const sortedAnnouncements = [...filteredAnnouncements].sort((a, b) => {
                return new Date(b.date) - new Date(a.date);
            });
            
            sortedAnnouncements.forEach(announcement => {
                announcementsHTML += `
                    <div class="announcement-card">
                        <h3>${announcement.title}</h3>
                        <div class="announcement-meta">
                            <span><strong>Hora:</strong> ${announcement.time}</span>
                            <span><strong>Fecha:</strong> ${announcement.date}</span>
                        </div>
                        <div class="announcement-category">${announcement.category}</div>
                        <div class="announcement-description">
                            ${announcement.description}
                        </div>
                    </div>
                `;
            });
            
            announcementsContainer.innerHTML = announcementsHTML;
        }

        // Renderizar todos los anuncios en el panel de administrador
        function renderAdminAnnouncements() {
            // Mostrar mensaje si no hay anuncios
            if (announcements.length === 0) {
                adminEmptyMessage.style.display = 'block';
                adminAnnouncements.innerHTML = '';
                adminAnnouncements.appendChild(adminEmptyMessage);
                return;
            }
            
            // Ocultar mensaje de vacío
            adminEmptyMessage.style.display = 'none';
            
            // Generar HTML de los anuncios
            let adminAnnouncementsHTML = '';
            
            // Ordenar por fecha (más reciente primero)
            const sortedAnnouncements = [...announcements].sort((a, b) => {
                return new Date(b.date) - new Date(a.date);
            });
            
            sortedAnnouncements.forEach(announcement => {
                adminAnnouncementsHTML += `
                    <div class="announcement-card">
                        <h3>${announcement.title}</h3>
                        <div class="announcement-meta">
                            <span><strong>Hora:</strong> ${announcement.time}</span>
                            <span><strong>Fecha:</strong> ${announcement.date}</span>
                            <span><strong>ID:</strong> ${announcement.id}</span>
                        </div>
                        <div class="announcement-category">${announcement.category}</div>
                        <div class="announcement-description">
                            ${announcement.description}
                        </div>
                    </div>
                `;
            });
            
            adminAnnouncements.innerHTML = adminAnnouncementsHTML;
        }

        // Mostrar mensajes temporales
        function showMessage(text, type) {
            formMessage.textContent = text;
            formMessage.className = `message ${type}`;
            
            // Ocultar mensaje después de 3 segundos
            setTimeout(() => {
                formMessage.style.display = 'none';
            }, 3000);
        }

        // Inicializar la aplicación cuando se carga la página
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
